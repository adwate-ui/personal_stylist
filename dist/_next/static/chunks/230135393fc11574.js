(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},78416,e=>{"use strict";function t(e){let t=e.toLowerCase();return t.includes("shirt")||t.includes("top")||t.includes("blouse")?"ðŸ‘”":t.includes("pant")||t.includes("jean")||t.includes("trouser")?"ðŸ‘–":t.includes("dress")||t.includes("gown")?"ðŸ‘—":t.includes("shoe")||t.includes("sneaker")||t.includes("boot")?"ðŸ‘Ÿ":t.includes("jacket")||t.includes("coat")||t.includes("blazer")?"ðŸ§¥":t.includes("bag")||t.includes("purse")||t.includes("clutch")?"ðŸ‘œ":t.includes("watch")||t.includes("accessory")?"âŒš":t.includes("hat")||t.includes("cap")?"ðŸ§¢":t.includes("scarf")?"ðŸ§£":t.includes("glasses")||t.includes("sunglasses")?"ðŸ•¶ï¸":"ðŸ‘•"}async function r(e,t,r){try{let a=[e,t,r,"official site"].filter(Boolean).join(" ");try{let r=await fetch("https://link-scraper.adwate.workers.dev/search-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a,limit:5})});if(r.ok){let i=await r.json(),s=[];for(let r of(i.results&&Array.isArray(i.results)?s=i.results:i.items&&Array.isArray(i.items)?s=i.items:i.url&&(s=[i]),console.log(`[Product Search] Found ${s.length} candidates for "${a}"`),s))if(r.url&&r.url.startsWith("http")&&!r.url.includes("google.com/search"))try{console.log(`[Product Search] Checking image for: ${r.url}`);let a=await fetch(`https://authentiqc-worker.adwate.workers.dev/fetch-metadata?url=${encodeURIComponent(r.url)}`);if(a.ok){let i=await a.json(),s=i.image||(i.images&&i.images.length>0?i.images[0]:null);if(s)return console.log(`[Product Search] âœ… Valid image found: ${s}`),{url:r.url,imageUrl:s,title:r.title||i.title||t,price:r.price||i.price,brand:r.brand||e}}}catch(e){console.warn(`[Product Search] Failed to check image for ${r.url}`,e)}if(s.length>0&&s[0].url)return console.log(`[Product Search] âš ï¸ No images found, returning first result.`),{url:s[0].url,imageUrl:s[0].imageUrl,title:s[0].title,price:s[0].price,brand:s[0].brand}}}catch(e){console.warn("Worker search failed, using fallback",e)}return{url:`https://www.google.com/search?q=${encodeURIComponent(a)}&tbm=shop`,imageUrl:void 0}}catch(e){return console.error("Error fetching product data:",e),{url:"#"}}}e.s(["getFirstSearchResultUrl",()=>r,"getProductImagePlaceholder",()=>t])},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},66654,e=>{"use strict";var t=e.i(62636);let r="gemini-3-pro-preview",a="gemini-2.5-flash",i="gemini-1.5-pro-latest",s="gemini-1.5-flash-latest";async function l(e){let t=[r,a,i,s];for(let r=0;r<t.length;r++){let a=t[r],i=r===t.length-1;try{return e.getGenerativeModel({model:a})}catch(e){if((e?.message?.includes("429")||e?.message?.includes("quota"))&&(console.warn(`Model ${a} quota exceeded, trying next model...`),!i)||(console.warn(`Model ${a} unavailable: ${e?.message}`),!i))continue;throw e}}return e.getGenerativeModel({model:s})}async function o(e,l,o,n){let c=new t.GoogleGenerativeAI(l),d=await u(e),p=o&&o.toLowerCase().includes("india")?"â‚¹":"$",g=n&&n.length>0?`

User's Current Wardrobe:
${n.map((e,t)=>`${t+1}. ${e.name||e.category} (${e.color||"color N/A"})`).join("\n")}

For complementary_items, ONLY suggest items from the above wardrobe list by their exact names.`:'\n\nUser has no wardrobe items yet. For complementary_items, suggest 5 general item types (e.g., "White sneakers", "Navy chinos") that would pair well.',f=`Analyze this clothing item for a personal stylist app. Return ONLY a valid JSON object (no markdown, no backticks) with these fields:
    - category: string (Top, Bottom, Outerwear, Shoes, Accessory, Dress, Bag, Other)
    - sub_category: string (e.g., T-Shirt, Jeans, Blazer, Sneakers)
    - primary_color: string (precise color name AND hex code, e.g., "Navy Blue #1A2B3C", "Charcoal Gray #36454F", "Crimson Red #DC143C")
    - style_tags: string[] (e.g., ["casual", "streetwear", "minimalist", "vintage"])
    - description: string (short, engaging description)
    - price_estimate: string (e.g., "${p} 1500", "${p} 2000-5000") - use numeric values with currency symbol. Do NOT use abstract signs like $$$.
    - style_score: number (1-100, purely objective style rating based on versatility and trend)
    - style_reasoning: string (2-3 sentences explaining the style score and how this item fits into a wardrobe)
    - brand: string (brand name if visible, else empty)
    - styling_tips: string[] (3 short tips on how to style this item)
    - complementary_items: string[] (5 items that would pair well with this piece${n&&n.length>0?" - ONLY from the user's wardrobe list above":""})
    ${g}`,y=[r,a,i,s];for(let t=0;t<y.length;t++){let r=y[t],a=t===y.length-1;try{let t=c.getGenerativeModel({model:r}),a=await t.generateContent([f,{inlineData:{data:d,mimeType:e.type}}]),i=a.response.candidates?.[0]?.content?.parts?.[0]?.text||"";if(!i)throw Error("No text content in Gemini response");let s=m(i);return JSON.parse(s)}catch(e){if((e?.message?.includes("429")||e?.message?.includes("quota"))&&!a){console.warn(`Model ${r} quota exceeded, trying next model...`);continue}if(a)throw h(e);console.warn(`Model ${r} failed: ${e?.message}`);continue}}throw Error("All models failed")}async function n(e,l,o,n,c,d){let p=new t.GoogleGenerativeAI(n),g=c&&c.toLowerCase().includes("india")?"â‚¹":"$",f=d&&d.length>0?`

User's Current Wardrobe:
${d.map((e,t)=>`${t+1}. ${e.name||e.category} (${e.color||"color N/A"})`).join("\n")}

For complementary_items, ONLY suggest items from the above wardrobe list by their exact names.`:"",y=`
    CONTEXT FROM LINK METADATA (Use as ground truth if available):
    URL: ${e}
    Title: "${l.title||""}"
    Brand: "${l.brand||""}"
    Price: "${l.price||""}"
    Description: "${l.description||""}"
    `,b=`Analyze this product from a URL store link. 
    ${y}
    
    Return ONLY a valid JSON object (no markdown, no backticks) with these fields:
    - category: string (Top, Bottom, Outerwear, Shoes, Accessory, Dress, Bag, Other)
    - sub_category: string (e.g., T-Shirt, Jeans, Blazer, Sneakers)
    - primary_color: string (precise color name AND hex code, e.g., "Navy Blue #1A2B3C")
    - style_tags: string[] (e.g., ["casual", "streetwear", "minimalist", "vintage"])
    - description: string (short, engaging description based on the link info)
    - price_estimate: string (Use the metadata price if available, else estimate: "${g} 1500", "${g} 2000-5000")
    - style_score: number (1-100, purely objective style rating)
    - style_reasoning: string (2-3 sentences explaining the style score)
    - brand: string (Use metadata brand if available - "${l.brand||""}")
    - styling_tips: string[] (3 short tips)
    - complementary_items: string[] (5 items that would pair well - ${d&&d.length>0?"ONLY from user wardrobe":"generics"})
    ${f}`,x=[r,a,i,s];for(let e=0;e<x.length;e++){let t=x[e];try{let e=p.getGenerativeModel({model:t}),r=[b];if(o){let e=await u(o);r.push({inlineData:{data:e,mimeType:o.type}})}let a=await e.generateContent(r),i=a.response.candidates?.[0]?.content?.parts?.[0]?.text||"";if(!i)throw Error("No text content");return JSON.parse(m(i))}catch(r){if(console.warn(`Model ${t} failed for Link Analysis: ${r?.message}`),e===x.length-1)throw h(r)}}throw Error("All models failed")}async function c(e,l){let o=new t.GoogleGenerativeAI(l),n=await u(e),c=`Act as a world-class fashion stylist. Rate this item/outfit on a scale of 1-10.
        Return ONLY a valid JSON object (no markdown) with:
        - score: number (1-10)
        - critique: string (honest, constructive feedback, max 2 sentences)
        - alternatives: string[] (3 better alternative item names or styles)
        `,d=[r,a,i,s];for(let t=0;t<d.length;t++){let r=d[t],a=t===d.length-1;try{let t=o.getGenerativeModel({model:r}),a=await t.generateContent([c,{inlineData:{data:n,mimeType:e.type}}]),i=a.response.candidates?.[0]?.content?.parts?.[0]?.text||"";if(!i)throw Error("No text content in Gemini response");let s=m(i);return JSON.parse(s)}catch(e){if((e?.message?.includes("429")||e?.message?.includes("quota"))&&!a){console.warn(`Model ${r} quota exceeded, trying next model...`);continue}if(a)throw h(e);console.warn(`Model ${r} failed: ${e?.message}`);continue}}throw Error("All models failed")}async function d(e,r,a,i,s,o){if(!s)throw Error("API Key required");let n=new t.GoogleGenerativeAI(s),c=o&&o.length>0?`CRITICAL INSTRUCTION: You MUST include the following Item IDs in your outfit selection: ${o.join(", ")}. Build the rest of the outfit around these items.`:"",d=e.map(e=>`- ID: ${e.id}, ${e.name||e.sub_category} (${e.category}, ${e.primary_color||"color N/A"})`).join("\n"),u=`
    Act as the world's most prestigious and talented personal stylist, known for impeccable taste and attention to detail. 
    You are styling your most important client for a specific occasion. Your goal is perfection.

    OCCASION: ${r}
    TIMING: ${a}
    LOCATION: ${i||"Unknown"}
    
    WARDROBE ITEMS:
    ${d}

    INSTRUCTIONS:
    1. Select the ABSOLUTE BEST combination of items from the provided WARDROBE ITEMS list.
    2. Ensure colors, textures, and styles harmonize perfectly.
    3. Respect the occasion deeply(e.g., ensure formal wear is truly formal).
    4. You MUST use the exact ID provided in the list.
    5. ${c}
    
    Return verified JSON only:
    {
        "top_id": "uuid",
        "bottom_id": "uuid",
        "shoes_id": "uuid",
        "layering_id": "uuid",
        "bag_id": "uuid",
        "sunglasses_id": "uuid",
        "jewelry_id": "uuid",
        "headwear_id": "uuid",
        "belt_id": "uuid",
        "scarf_id": "uuid",
        "gloves_id": "uuid",
        "reasoning": "Sophisticated styling advice explaining why this specific combination works flawlessly for the occasion.",
        "style_tips": ["Professional styling tip 1", "Tip 2"]
    }
    `,h=await l(n),p=await h.generateContent(u),g=JSON.parse(m(p.response.candidates?.[0]?.content?.parts?.[0]?.text||"")),f=t=>e.find(e=>e.id===t);return{top:f(g.top_id),bottom:f(g.bottom_id),shoes:f(g.shoes_id),layering:f(g.layering_id),bag:f(g.bag_id),sunglasses:f(g.sunglasses_id),jewelry:f(g.jewelry_id),headwear:f(g.headwear_id),belt:f(g.belt_id),scarf:f(g.scarf_id),gloves:f(g.gloves_id),reasoning:g.reasoning,style_tips:g.style_tips}}async function u(e){return new Promise((t,r)=>{let a=new FileReader;a.onloadend=()=>{t(a.result.split(",")[1])},a.onerror=r,a.readAsDataURL(e)})}function m(e){return e.replace(/```json/g,"").replace(/```/g,"").trim()}function h(e){console.error("Gemini Error:",e);let t="Failed to analyze image. Please check your API key.";return e instanceof Error&&(e.message.includes("429")||e.message.includes("quota")?t="All Gemini models exhausted quota limits. Free tier has daily limits. Please wait or upgrade at https://ai.google.dev/pricing":e.message.includes("404")||e.message.includes("not found")?t="Gemini model unavailable. Please check your API key has access to the latest models.":(e.message.includes("API key")||e.message.includes("API_KEY"))&&(t="Invalid API Key. Please check your settings.")),Error(t)}e.s(["analyzeImageWithGemini",()=>o,"analyzeLinkWithGemini",()=>n,"generateOutfit",()=>d,"rateImageWithGemini",()=>c])},87246,e=>{"use strict";var t=e.i(43476);function r({className:e}){return(0,t.jsx)("div",{className:`animate-pulse bg-white/5 rounded-lg ${e}`})}function a(){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"p-8 rounded-2xl glass border border-white/10 flex flex-col items-center gap-4",children:[(0,t.jsx)(r,{className:"h-20 w-32 rounded-xl"}),(0,t.jsx)(r,{className:"h-4 w-24"})]}),(0,t.jsxs)("div",{className:"p-6 rounded-2xl bg-white/5 border border-white/10 space-y-4",children:[(0,t.jsx)(r,{className:"h-6 w-40"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r,{className:"h-4 w-full"}),(0,t.jsx)(r,{className:"h-4 w-full"}),(0,t.jsx)(r,{className:"h-4 w-3/4"})]})]})]})}function i(){return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"aspect-[3/4] bg-white/5 rounded-2xl animate-pulse"}),(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10 space-y-3",children:[(0,t.jsx)(r,{className:"h-5 w-32"}),(0,t.jsx)(r,{className:"h-4 w-full"}),(0,t.jsx)(r,{className:"h-4 w-2/3"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col h-full space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(r,{className:"h-5 w-24"}),(0,t.jsx)(r,{className:"h-5 w-24"})]}),(0,t.jsx)(r,{className:"h-10 w-3/4"}),(0,t.jsx)(r,{className:"h-20 w-full"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(r,{className:"h-16 w-full"}),(0,t.jsx)(r,{className:"h-16 w-full"})]}),(0,t.jsxs)("div",{className:"mt-auto flex gap-4 pt-8",children:[(0,t.jsx)(r,{className:"h-12 flex-1"}),(0,t.jsx)(r,{className:"h-12 flex-[2]"})]})]})]})}e.s(["AddItemSkeleton",()=>i,"ShopAnalysisSkeleton",()=>a])},67423,(e,t,r)=>{"use strict";function a({widthInt:e,heightInt:t,blurWidth:r,blurHeight:a,blurDataURL:i,objectFit:s}){let l=r?40*r:e,o=a?40*a:t,n=l&&o?`viewBox='0 0 ${l} ${o}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${n}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${n?"none":"contain"===s?"xMidYMid":"cover"===s?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${i}'/%3E%3C/svg%3E`}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImageBlurSvg",{enumerable:!0,get:function(){return a}})},87690,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={VALID_LOADERS:function(){return s},imageConfigDefault:function(){return l}};for(var i in a)Object.defineProperty(r,i,{enumerable:!0,get:a[i]});let s=["default","imgix","cloudinary","akamai","custom"],l={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},8927,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImgProps",{enumerable:!0,get:function(){return n}}),e.r(33525);let a=e.r(67423),i=e.r(87690),s=["-moz-initial","fill","none","scale-down",void 0];function l(e){return void 0!==e.default}function o(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function n({src:e,sizes:t,unoptimized:r=!1,priority:n=!1,preload:c=!1,loading:d,className:u,quality:m,width:h,height:p,fill:g=!1,style:f,overrideSrc:y,onLoad:b,onLoadingComplete:x,placeholder:w="empty",blurDataURL:v,fetchPriority:j,decoding:_="async",layout:k,objectFit:N,objectPosition:A,lazyBoundary:S,lazyRoot:P,...I},C){var $;let O,E,R,{imgConf:z,showAltText:U,blurComplete:F,defaultLoader:T}=C,M=z||i.imageConfigDefault;if("allSizes"in M)O=M;else{let e=[...M.deviceSizes,...M.imageSizes].sort((e,t)=>e-t),t=M.deviceSizes.sort((e,t)=>e-t),r=M.qualities?.sort((e,t)=>e-t);O={...M,allSizes:e,deviceSizes:t,qualities:r}}if(void 0===T)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let L=I.loader||T;delete I.loader,delete I.srcSet;let D="__next_img_default"in L;if(D){if("custom"===O.loader)throw Object.defineProperty(Error(`Image with src "${e}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=L;L=t=>{let{config:r,...a}=t;return e(a)}}if(k){"fill"===k&&(g=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[k];e&&(f={...f,...e});let r={responsive:"100vw",fill:"100vw"}[k];r&&!t&&(t=r)}let G="",q=o(h),B=o(p);if(($=e)&&"object"==typeof $&&(l($)||void 0!==$.src)){let t=l(e)?e.default:e;if(!t.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!t.height||!t.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(E=t.blurWidth,R=t.blurHeight,v=v||t.blurDataURL,G=t.src,!g)if(q||B){if(q&&!B){let e=q/t.width;B=Math.round(t.height*e)}else if(!q&&B){let e=B/t.height;q=Math.round(t.width*e)}}else q=t.width,B=t.height}let W=!n&&!c&&("lazy"===d||void 0===d);(!(e="string"==typeof e?e:G)||e.startsWith("data:")||e.startsWith("blob:"))&&(r=!0,W=!1),O.unoptimized&&(r=!0),D&&!O.dangerouslyAllowSVG&&e.split("?",1)[0].endsWith(".svg")&&(r=!0);let J=o(m),Y=Object.assign(g?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:N,objectPosition:A}:{},U?{}:{color:"transparent"},f),K=F||"empty"===w?null:"blur"===w?`url("data:image/svg+xml;charset=utf-8,${(0,a.getImageBlurSvg)({widthInt:q,heightInt:B,blurWidth:E,blurHeight:R,blurDataURL:v||"",objectFit:Y.objectFit})}")`:`url("${w}")`,V=s.includes(Y.objectFit)?"fill"===Y.objectFit?"100% 100%":"cover":Y.objectFit,X=K?{backgroundSize:V,backgroundPosition:Y.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:K}:{},H=function({config:e,src:t,unoptimized:r,width:a,quality:i,sizes:s,loader:l}){if(r)return{src:t,srcSet:void 0,sizes:void 0};let{widths:o,kind:n}=function({deviceSizes:e,allSizes:t},r,a){if(a){let r=/(^|\s)(1?\d?\d)vw/g,i=[];for(let e;e=r.exec(a);)i.push(parseInt(e[2]));if(i.length){let r=.01*Math.min(...i);return{widths:t.filter(t=>t>=e[0]*r),kind:"w"}}return{widths:t,kind:"w"}}return"number"!=typeof r?{widths:e,kind:"w"}:{widths:[...new Set([r,2*r].map(e=>t.find(t=>t>=e)||t[t.length-1]))],kind:"x"}}(e,a,s),c=o.length-1;return{sizes:s||"w"!==n?s:"100vw",srcSet:o.map((r,a)=>`${l({config:e,src:t,quality:i,width:r})} ${"w"===n?r:a+1}${n}`).join(", "),src:l({config:e,src:t,quality:i,width:o[c]})}}({config:O,src:e,unoptimized:r,width:q,quality:J,sizes:t,loader:L}),Q=W?"lazy":d;return{props:{...I,loading:Q,fetchPriority:j,width:q,height:B,decoding:_,className:u,style:{...Y,...X},sizes:H.sizes,srcSet:H.srcSet,src:y||H.src},meta:{unoptimized:r,preload:c||n,placeholder:w,fill:g}}}},98879,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o}});let a=e.r(71645),i="undefined"==typeof window,s=i?()=>{}:a.useLayoutEffect,l=i?()=>{}:a.useEffect;function o(e){let{headManager:t,reduceComponentsToState:r}=e;function o(){if(t&&t.mountedInstances){let e=a.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(e))}}return i&&(t?.mountedInstances?.add(e.children),o()),s(()=>(t?.mountedInstances?.add(e.children),()=>{t?.mountedInstances?.delete(e.children)})),s(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),l(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},25633,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={default:function(){return g},defaultHead:function(){return u}};for(var i in a)Object.defineProperty(r,i,{enumerable:!0,get:a[i]});let s=e.r(55682),l=e.r(90809),o=e.r(43476),n=l._(e.r(71645)),c=s._(e.r(98879)),d=e.r(42732);function u(){return[(0,o.jsx)("meta",{charSet:"utf-8"},"charset"),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")]}function m(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===n.default.Fragment?e.concat(n.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(33525);let h=["name","httpEquiv","charSet","itemProp"];function p(e){let t,r,a,i;return e.reduce(m,[]).reverse().concat(u().reverse()).filter((t=new Set,r=new Set,a=new Set,i={},e=>{let s=!0,l=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){l=!0;let r=e.key.slice(e.key.indexOf("$")+1);t.has(r)?s=!1:t.add(r)}switch(e.type){case"title":case"base":r.has(e.type)?s=!1:r.add(e.type);break;case"meta":for(let t=0,r=h.length;t<r;t++){let r=h[t];if(e.props.hasOwnProperty(r))if("charSet"===r)a.has(r)?s=!1:a.add(r);else{let t=e.props[r],a=i[r]||new Set;("name"!==r||!l)&&a.has(t)?s=!1:(a.add(t),i[r]=a)}}}return s})).reverse().map((e,t)=>{let r=e.key||t;return n.default.cloneElement(e,{key:r})})}let g=function({children:e}){let t=(0,n.useContext)(d.HeadManagerContext);return(0,o.jsx)(c.default,{reduceComponentsToState:p,headManager:t,children:e})};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return s}});let a=e.r(55682)._(e.r(71645)),i=e.r(87690),s=a.default.createContext(i.imageConfigDefault)},65856,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouterContext",{enumerable:!0,get:function(){return a}});let a=e.r(55682)._(e.r(71645)).default.createContext(null)},70965,(e,t,r)=>{"use strict";function a(e,t){let r=e||75;return t?.qualities?.length?t.qualities.reduce((e,t)=>Math.abs(t-r)<Math.abs(e-r)?t:e,0):r}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"findClosestQuality",{enumerable:!0,get:function(){return a}})},1948,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return s}});let a=e.r(70965);function i({config:e,src:t,width:r,quality:i}){if(t.startsWith("/")&&t.includes("?")&&e.localPatterns?.length===1&&"**"===e.localPatterns[0].pathname&&""===e.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${t}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let s=(0,a.findClosestQuality)(i,e);return`${e.path}?url=${encodeURIComponent(t)}&w=${r}&q=${s}${t.startsWith("/_next/static/media/"),""}`}i.__next_img_default=!0;let s=i},5500,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return w}});let a=e.r(55682),i=e.r(90809),s=e.r(43476),l=i._(e.r(71645)),o=a._(e.r(74080)),n=a._(e.r(25633)),c=e.r(8927),d=e.r(87690),u=e.r(18556);e.r(33525);let m=e.r(65856),h=a._(e.r(1948)),p=e.r(18581),g={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function f(e,t,r,a,i,s,l){let o=e?.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&i(!0),r?.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let a=!1,i=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>a,isPropagationStopped:()=>i,persist:()=>{},preventDefault:()=>{a=!0,t.preventDefault()},stopPropagation:()=>{i=!0,t.stopPropagation()}})}a?.current&&a.current(e)}}))}function y(e){return l.use?{fetchPriority:e}:{fetchpriority:e}}"undefined"==typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let b=(0,l.forwardRef)(({src:e,srcSet:t,sizes:r,height:a,width:i,decoding:o,className:n,style:c,fetchPriority:d,placeholder:u,loading:m,unoptimized:h,fill:g,onLoadRef:b,onLoadingCompleteRef:x,setBlurComplete:w,setShowAltText:v,sizesInput:j,onLoad:_,onError:k,...N},A)=>{let S=(0,l.useCallback)(e=>{e&&(k&&(e.src=e.src),e.complete&&f(e,u,b,x,w,h,j))},[e,u,b,x,w,k,h,j]),P=(0,p.useMergedRef)(A,S);return(0,s.jsx)("img",{...N,...y(d),loading:m,width:i,height:a,decoding:o,"data-nimg":g?"fill":"1",className:n,style:c,sizes:r,srcSet:t,src:e,ref:P,onLoad:e=>{f(e.currentTarget,u,b,x,w,h,j)},onError:e=>{v(!0),"empty"!==u&&w(!0),k&&k(e)}})});function x({isAppRouter:e,imgAttributes:t}){let r={as:"image",imageSrcSet:t.srcSet,imageSizes:t.sizes,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,...y(t.fetchPriority)};return e&&o.default.preload?(o.default.preload(t.src,r),null):(0,s.jsx)(n.default,{children:(0,s.jsx)("link",{rel:"preload",href:t.srcSet?void 0:t.src,...r},"__nimg-"+t.src+t.srcSet+t.sizes)})}let w=(0,l.forwardRef)((e,t)=>{let r=(0,l.useContext)(m.RouterContext),a=(0,l.useContext)(u.ImageConfigContext),i=(0,l.useMemo)(()=>{let e=g||a||d.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t),i=e.qualities?.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r,qualities:i,localPatterns:"undefined"==typeof window?a?.localPatterns:e.localPatterns}},[a]),{onLoad:o,onLoadingComplete:n}=e,p=(0,l.useRef)(o);(0,l.useEffect)(()=>{p.current=o},[o]);let f=(0,l.useRef)(n);(0,l.useEffect)(()=>{f.current=n},[n]);let[y,w]=(0,l.useState)(!1),[v,j]=(0,l.useState)(!1),{props:_,meta:k}=(0,c.getImgProps)(e,{defaultLoader:h.default,imgConf:i,blurComplete:y,showAltText:v});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{..._,unoptimized:k.unoptimized,placeholder:k.placeholder,fill:k.fill,onLoadRef:p,onLoadingCompleteRef:f,setBlurComplete:w,setShowAltText:j,sizesInput:e.sizes,ref:t}),k.preload?(0,s.jsx)(x,{isAppRouter:!r,imgAttributes:_}):null]})});("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},94909,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={default:function(){return d},getImageProps:function(){return c}};for(var i in a)Object.defineProperty(r,i,{enumerable:!0,get:a[i]});let s=e.r(55682),l=e.r(8927),o=e.r(5500),n=s._(e.r(1948));function c(e){let{props:t}=(0,l.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let d=o.Image},57688,(e,t,r)=>{t.exports=e.r(94909)},6339,e=>{"use strict";var t=e.i(43476),r=e.i(46696),a=e.i(71645);let i={silhouette:"The overall outline or shape of a garment.",bespoke:"Clothing made to an individual buyer's specifications; custom-made.","bias cut":"Fabric cut at a 45-degree angle to allowing it to drape softly over the body's curves.",peplum:"A short, gathered or pleated strip of fabric attached at the waist of a woman's jacket, dress, or blouse.","empire waist":"A fitted bodice ending just below the bust, giving a high-waisted appearance.","drop waist":"A waistline that sits below the natural waist, often at the hips.","a-line":"A silhouette that is narrower at the top and flares gently wider toward the bottom.",chukka:"A specific variation of ankle-high boots usually made from suede or leather with open lacing.",loafer:"A slip-on shoe with no laces, often featuring a low heel and moccasin-like construction.",sneaker:"A shoe designed primarily for sports or physical exercise, but mostly used for everyday casual wear.",brogue:"A low-heeled shoe or boot characterized by sturdy leather uppers with decorative perforations (broguing).",espadrille:"A casual shoe with a canvas or cotton fabric upper and a flexible sole made of esparto rope.",oxford:"A classic dress shoe with closed lacing, where the shoelace eyelets tabs are attached under the vamp.",derby:"A boot or shoe with open lacing, meaning that the eyelets are sewn on top of the vamp.","chelsea boot":"A close-fitting, ankle-high boot with an elastic side panel.",mule:"A shoe that has no back or constraint around the foot's heel.",blazer:"A structured jacket resembling a suit jacket but cut more casually.",tunic:"A loose garment, typically sleeveless and reaching to the knees, as worn in ancient Greece and Rome.",cardigan:"A knitted sweater opening down the front, typically with buttons.","bomber jacket":"A short jacket gathered at the waist and cuffs by elasticated bands and typically having a zip front.","trench coat":"A loose-belted, double-breasted raincoat in a military style.",camisole:"A loose-fitting sleeveless undergarment or top for women, typically with thin straps.",culottes:"Women's knee-length trousers, cut with full legs to resemble a skirt.",chino:"Casual trousers made from chino cloth, a twill fabric, typically khaki-colored.",palazzo:"Long women's trousers cut with a loose, extremely wide leg that flares out from the waist.","pencil skirt":"A slim-fitting skirt with a straight, narrow cut.","sheath dress":"A fitted, straight-cut dress, often without a waist seam.",cashmere:"A soft, fine wool obtained from the cashmere goat.",bouclÃ©:"A yarn with a looped or curled ply, or the fabric made from this yarn.",brocade:"A rich fabric, usually silk, woven with a raised pattern, typically with gold or silver thread.",chambray:"A lightweight clothing fabric with colored warp and white filling yarns.",organza:"A thin, stiff, transparent fabric made of silk or a synthetic yarn.",taffeta:"A crisp, smooth, plain-woven fabric with a slight sheen.",tweed:"A rough-surfaced woolen cloth, typically of mixed flecked colors.","old money":"A style characterized by understated luxury, classic pieces, and high-quality materials without overt logos.","avant-garde":"Experimental, innovative, or unorthodox concepts in fashion.","haute couture":"Expensive, fashionable clothes produced by leading fashion houses.",minimalist:"A style focused on clean lines, simple geometric shapes, and a lack of decorative detail.",eclectic:"A style that derives ideas, style, or taste from a broad and diverse range of sources.",bohemian:"Unconventional and artistic style, often involving loose, flowing fabrics and colorful patterns.",preppy:"A classic, neat style inspired by the clothing of American preparatory schools.",streetwear:"Casual clothing of a style worn especially by members of various urban youth subcultures.",utilitarian:"Fashion that prioritizes function, practicality, and comfort.",monochrome:"An outfit consisting of pieces of one single color or shades of that color.","trompe-l'Å“il":"Visual illusion in art/fashion, used to trick the eye into perceiving a painted detail as a three-dimensional object.",appliquÃ©:"Ornamental needlework in which pieces of fabric are sewn or stuck onto a large piece of fabric to form a picture or pattern.",embroidery:"The art or process of forming decorative designs with hand or machine needlework.",pleating:"A type of fold formed by doubling fabric back upon itself and securing it in place.",ruching:"A gathering of fabric or ribbon to produce a ripple or ruffle effect.",atelier:"A workshop or studio, especially one used by an artist or fashion designer.","capsule wardrobe":"A collection of a few essential items of clothing that do not go out of fashion.","prÃªt-Ã -porter":"Designer clothes sold ready-to-wear rather than made to measure.",sartorial:"Relating to tailoring, clothes, or style of dress.",texture:"The perceived surface quality of a garment or fabric."};function s({text:e,className:r=""}){if(!e)return null;let a=function(e){if(!e)return[e];let t=Object.keys(i).sort((e,t)=>t.length-e.length),r=RegExp(`(${t.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|")})`,"gi");return e.split(r)}(e);return(0,t.jsx)("span",{className:r,children:a.map((e,r)=>{let a=e.toLowerCase(),s=i[a];return s?(0,t.jsxs)("span",{className:"group relative inline-block cursor-help border-b border-dotted border-primary/50 hover:border-primary transition-colors",children:[(0,t.jsx)("span",{className:"text-primary/90 font-medium",children:e}),(0,t.jsxs)("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-64 p-3 bg-gray-900/95 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl text-xs text-start opacity-0 group-hover:opacity-100 transition-all duration-200 pointer-events-none z-50 transform group-hover:-translate-y-1",children:[(0,t.jsx)("span",{className:"block font-bold text-primary mb-1 capitalize border-b border-white/10 pb-1",children:a}),(0,t.jsx)("span",{className:"text-gray-300 leading-relaxed block",children:s}),(0,t.jsx)("span",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900/95"})]})]},r):(0,t.jsx)("span",{children:e},r)})})}var l=e.i(87246),o=e.i(69074),n=e.i(75254);let c=(0,n.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var d=e.i(31278),u=e.i(63209),m=e.i(72520),h=e.i(25652);let p=(0,n.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),g=(0,n.default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var f=e.i(18566),y=e.i(57688),b=e.i(33426),x=e.i(66654),w=e.i(7984),v=e.i(78416);function j(){let e,i,n,j,_=(0,f.useRouter)(),{profile:k}=(0,b.useProfile)(),[N,A]=(0,a.useState)("upload"),[S,P]=(0,a.useState)(!1),[I,C]=(0,a.useState)(0),[$,O]=(0,a.useState)([]),[E,R]=(0,a.useState)(""),[z,U]=(0,a.useState)(null),F=()=>{C(0);let e=setInterval(()=>{C(t=>t>=90?(clearInterval(e),90):t+10)},500);return e},T=async e=>{if(!e.target.files?.[0])return;P(!0);let t=F();U(null);let a=e.target.files[0];try{let e=k.gemini_api_key||localStorage.getItem("gemini_api_key");if(!e){r.toast.error("API Key Required",{description:"Please set your Gemini API key in your profile to use AI analysis.",duration:6e3,action:{label:"Go to Profile",onClick:()=>_.push("/profile")}}),clearInterval(t),P(!1);return}let i=await (0,x.analyzeImageWithGemini)(a,e,k.location,$);if(clearInterval(t),C(100),i.error)throw Error(i.message||i.error);i.image_url=URL.createObjectURL(a),i.primary_color&&!i.color&&(i.color=i.primary_color),U(i)}catch(e){console.error(e),r.toast.error("Analysis Failed",{description:e.message||"Please try again.",duration:5e3}),clearInterval(t)}finally{P(!1)}},M=async e=>{e.preventDefault(),P(!0);let t=F();U(null);try{let e,a={imageUrl:null,imageBase64:null,title:null,price:null,brand:null},i=!1;try{if(E.includes("google.com/search"))throw Error("Skipping AuthentiQC for search URL");let e=await fetch(`https://authentiqc-worker.adwate.workers.dev/fetch-metadata?url=${encodeURIComponent(E)}`);if(e.ok){let t=await e.json();a.imageUrl=t.image||(t.images&&t.images.length>0?t.images[0]:null),a.title=t.title||null,a.price=t.price||null,a.brand=t.site_name||t.brand||null}else console.warn("[Add Item] Worker returned error status:",e.status),i=!0}catch(e){console.warn("[Add Item] Worker fetch failed:",e),i=!0}if(console.log("[Add Item] Worker response data:",a),!a.imageBase64&&!a.image&&!a.imageUrl||i){console.warn("[Add Item] No image found or worker failed, attempting fallback search...");try{console.log("[Add Item] Attempting fallback search with URL...");let e=await (0,v.getFirstSearchResultUrl)("",E,"");if(!e.imageUrl)try{let t=new URL(E),r=(t.pathname.split("/").filter(e=>e.length>2&&!["p","product","item","shop","en","in","html"].includes(e.toLowerCase())).pop()||"").replace(/[_]/g," ").replace(/-/g," ").replace(/\.html.*/,"").replace(/\d+/g,"").trim(),i=a.brand||t.hostname.replace("www.","").split(".")[0],s=`${i} ${r}`.trim();r.length>3&&(console.log("[Add Item] Attempting smart fallback search:",s),e=await (0,v.getFirstSearchResultUrl)(s,"",""))}catch(e){console.warn("Smart query generation failed:",e)}if(e.imageUrl)console.log("[Add Item] âœ… Fallback search found image:",e.imageUrl),a.imageUrl=e.imageUrl,a.title||(a.title=e.title),a.price||(a.price=e.price),a.brand||(a.brand=e.brand);else throw Error("Fallback search failed")}catch(e){console.error("[Add Item] Fallback failed:",e),clearInterval(t),P(!1),r.toast.error("Couldn't load product image",{description:"This site has strict security blocks. Please upload a screenshot instead.",duration:6e3});return}}try{if(a.imageBase64){let t=await fetch(a.imageBase64);e=await t.blob(),console.log("[Add Item] Using imageBase64")}else if(a.imageUrl||a.image){let t=a.imageUrl||a.image;console.log("[Add Item] Trying to fetch imageUrl:",t);try{let r=await fetch(t);if(!r.ok)throw Error(`Status ${r.status}`);e=await r.blob(),console.log("[Add Item] Successfully fetched imageUrl direct")}catch(r){console.warn("[Add Item] Direct fetch failed (likely CORS), trying proxy...",r);try{let r=`https://wsrv.nl/?url=${encodeURIComponent(t)}`,a=await fetch(r);if(!a.ok)throw Error(`Proxy Status ${a.status}`);e=await a.blob(),console.log("[Add Item] Successfully fetched imageUrl via proxy")}catch(e){throw Error("Failed to fetch image directly and via proxy")}}}else throw Error("No image data available")}catch(e){console.error("[Add Item] Image fetch failed:",e),clearInterval(t),P(!1),r.toast.error("Couldn't load product image",{description:`Failed to fetch image: ${e.message}. Try uploading a screenshot.`,duration:6e3}),A("upload");return}let s=new File([e],"product.jpg",{type:e.type}),l=k.gemini_api_key||localStorage.getItem("gemini_api_key");if(!l)throw r.toast.error("API Key Required",{description:"Please set your Gemini API key in your profile.",duration:6e3,action:{label:"Go to Profile",onClick:()=>_.push("/profile")}}),Error("API Key required");let o=await (0,x.analyzeLinkWithGemini)(E,a,s,l,k.location,$),n={...o,image_url:URL.createObjectURL(e),item_name:a.title||o.item_name,description:a.description||o.description,brand:a.brand||o.brand,price:a.price||o.price,color:o.primary_color||a.color};clearInterval(t),C(100),U(n)}catch(e){console.error(e),r.toast.error("Link Analysis Failed",{description:e.message||"Please check the URL or try uploading a photo.",duration:5e3}),clearInterval(t)}finally{P(!1)}},[L,D]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await w.supabase.auth.getUser();if(!e)return;let{data:t,error:r}=await w.supabase.from("wardrobe_items").select("sub_category, category, primary_color").eq("user_id",e.id).limit(50);if(r){console.error("Failed to fetch wardrobe - Full error:",r),console.error("Error details:",{message:r.message,details:r.details,hint:r.hint,code:r.code});return}t&&O(t.map(e=>({name:e.sub_category||e.category,category:e.category,color:e.primary_color})))}catch(e){console.error("Failed to fetch wardrobe:",e)}})()},[]),(0,a.useEffect)(()=>{let e=e=>{if("upload"!==N||z||S)return;let t=e.clipboardData?.items;if(t){for(let e=0;e<t.length;e++)if(-1!==t[e].type.indexOf("image")){let a=t[e].getAsFile();a&&(T({target:{files:[new File([a],"pasted-image.png",{type:a.type})]}}),r.toast.success("Image pasted from clipboard!"));break}}};return window.addEventListener("paste",e),()=>window.removeEventListener("paste",e)},[N,z,S]);let G=async()=>{if(z){D(!0);try{let{data:{user:e}}=await w.supabase.auth.getUser();if(!e)return void _.push("/auth/login");let t=z.image_url;if(z.image_url?.startsWith("blob:")){let r=await fetch(z.image_url).then(e=>e.blob()),a=`${e.id}/${Date.now()}.jpg`,{error:i}=await w.supabase.storage.from("wardrobe_items").upload(a,r);if(i)throw i;let{data:{publicUrl:s}}=w.supabase.storage.from("wardrobe_items").getPublicUrl(a);t=s}let{error:a}=await w.supabase.from("wardrobe_items").insert({user_id:e.id,image_url:t,category:z.category,sub_category:z.sub_category,brand:z.brand,primary_color:z.primary_color,price_estimate:z.price_estimate,description:z.description,style_tags:z.style_tags,style_score:z.style_score,ai_analysis:z});if(a)throw a;r.toast.success("Item added to wardrobe!"),_.push("/wardrobe")}catch(e){console.error("Save Error:",e),r.toast.error("Save Failed",{description:e.message||"Failed to save item. Please try again.",duration:5e3})}finally{D(!1)}}};return(0,t.jsxs)("div",{className:"p-6 md:p-8 max-w-4xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-4xl font-serif font-bold mb-2",children:"Add New Item"}),(0,t.jsx)("p",{className:"text-gray-400 mb-8",children:"Upload a photo or paste a link to get a detailed Style DNA analysis."}),(0,t.jsxs)("div",{className:"flex gap-4 mb-8 bg-surface p-1 rounded-xl border border-white/5 max-w-md",children:[(0,t.jsxs)("button",{onClick:()=>A("upload"),className:`flex-1 py-3 flex items-center justify-center gap-2 rounded-lg transition-all font-medium ${"upload"===N?"bg-primary text-black shadow-lg":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[(0,t.jsx)(o.Upload,{size:18})," Upload Photo"]}),(0,t.jsxs)("button",{onClick:()=>A("link"),className:`flex-1 py-3 flex items-center justify-center gap-2 rounded-lg transition-all font-medium ${"link"===N?"bg-primary text-black shadow-lg":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[(0,t.jsx)(c,{size:18})," Paste Link"]})]}),(0,t.jsxs)("div",{className:`card glass p-8 min-h-[400px] flex flex-col items-center justify-center relative shadow-2xl overflow-hidden transition-all duration-500 ${z?"items-stretch justify-start":""}`,children:[S&&(0,t.jsxs)("div",{className:"w-full relative",children:[(0,t.jsxs)("div",{className:"absolute inset-0 z-50 flex flex-col items-center justify-center p-8 text-center bg-black/50 backdrop-blur-sm rounded-xl",children:[(0,t.jsxs)("div",{className:"w-full max-w-sm mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs text-primary mb-2 font-mono uppercase tracking-widest",children:[(0,t.jsx)("span",{children:"Analyzing Style DNA"}),(0,t.jsxs)("span",{children:[I,"%"]})]}),(0,t.jsx)("div",{className:"h-1 bg-white/10 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-primary transition-all duration-300 ease-out shadow-[0_0_15px_#d4af37]",style:{width:`${I}%`}})})]}),(0,t.jsx)("h3",{className:"text-xl font-bold mb-2 text-white",children:"Gemini 3 Pro is analyzing..."}),(0,t.jsx)("p",{className:"text-gray-400 text-sm animate-pulse",children:"Identifying brand, SKU, and calculating style score."})]}),(0,t.jsx)(l.AddItemSkeleton,{})]}),L&&(0,t.jsxs)("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md z-50 flex flex-col items-center justify-center p-8 text-center animate-fade-in",children:[(0,t.jsx)(d.Loader2,{size:48,className:"text-primary animate-spin mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-bold mb-2 text-white",children:"Saving to Wardrobe..."})]}),!z&&!S&&"upload"===N&&(0,t.jsx)("div",{className:"w-full text-center max-w-md animate-fade-in",children:(0,t.jsxs)("div",{className:"border-2 border-dashed border-white/20 rounded-3xl h-80 flex flex-col items-center justify-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all group relative overflow-hidden",onClick:()=>document.getElementById("file-input")?.click(),children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-white/5 rounded-full flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:(0,t.jsx)(o.Upload,{size:32,className:"text-gray-400 group-hover:text-primary transition-colors"})}),(0,t.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Drop your image here"}),(0,t.jsx)("p",{className:"text-gray-400 text-sm max-w-xs",children:"Paste (Ctrl+V) or click to browse"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Supports JPG, PNG, WEBP up to 5MB"}),(0,t.jsx)("input",{id:"file-input",type:"file",className:"hidden",accept:"image/*",onChange:e=>T(e)})]})}),!z&&!S&&"link"===N&&(0,t.jsxs)("form",{onSubmit:M,className:"w-full max-w-md space-y-6 animate-fade-in",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-white/5 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-white/10",children:(0,t.jsx)(c,{size:32,className:"text-primary"})}),(0,t.jsx)("h3",{className:"text-xl font-bold",children:"Import from URL"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"url",placeholder:"https://store.com/product...",className:"w-full bg-black/50 border border-white/20 rounded-xl px-4 py-4 pr-12 text-white placeholder:text-gray-600 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all",value:E,onChange:e=>R(e.target.value),required:!0}),(0,t.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-600 pointer-events-none",children:(0,t.jsx)(c,{size:16})})]}),(0,t.jsxs)("button",{type:"submit",className:"btn btn-primary w-full py-4 text-base font-bold shadow-lg shadow-primary/20 hover:shadow-primary/40",disabled:!E||S,children:["Analyze Link ",(0,t.jsx)(m.ArrowRight,{size:18,className:"ml-2"})]})]}),z&&(0,t.jsxs)("div",{className:"w-full animate-fade-in grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"aspect-[3/4] bg-gray-900 rounded-2xl overflow-hidden border border-white/10 shadow-2xl relative group",children:[z.image_url?(0,t.jsx)(y.default,{src:z.image_url,alt:"Product",fill:!0,className:"object-cover"}):(0,t.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-600 bg-white/5",children:[(0,t.jsx)(u.AlertCircle,{size:32,className:"mb-2 opacity-50"}),(0,t.jsx)("span",{children:"No Image Available"})]}),(0,t.jsx)("div",{className:"absolute top-4 right-4 animate-in fade-in zoom-in duration-500 delay-300",children:(0,t.jsxs)("div",{className:"bg-black/70 backdrop-blur-md text-white px-4 py-2 rounded-full border border-white/10 shadow-xl flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs font-mono uppercase text-gray-400",children:"Style Score"}),(0,t.jsx)("span",{className:`text-xl font-bold ${z.style_score>80?"text-green-400":z.style_score>50?"text-yellow-400":"text-red-400"}`,children:z.style_score||"?"})]})})]}),(0,t.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl border border-white/10",children:[(0,t.jsxs)("h4",{className:"text-sm font-bold text-gray-300 mb-2 flex items-center gap-2",children:[(0,t.jsx)(h.TrendingUp,{size:16,className:"text-primary"})," Style Analysis"]}),(0,t.jsx)("p",{className:"text-sm text-gray-400 leading-relaxed",children:(0,t.jsx)(s,{text:z.style_reasoning||"Analyzing fit with your personal style..."})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-white/10 text-gray-300 uppercase tracking-widest border border-white/5",children:z.brand||"Unknown Brand"}),(0,t.jsx)("span",{className:"text-sm text-gray-400 font-mono",children:z.price||z.price_estimate||"Price Pending"})]}),(0,t.jsx)("h2",{className:"text-3xl font-serif font-bold leading-tight mb-4",children:z.item_name||z.sub_category||"Identified Item"}),(0,t.jsxs)("p",{className:"text-gray-300 leading-relaxed italic border-l-2 border-primary/30 pl-4 py-1",children:['"',(0,t.jsx)(s,{text:z.description}),'"']})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-black/20 p-3 rounded-lg border border-white/5",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 uppercase mb-1",children:"Category"}),(0,t.jsx)("div",{className:"font-medium text-sm",children:z.category})]}),(0,t.jsxs)("div",{className:"bg-black/20 p-3 rounded-lg border border-white/5",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 uppercase mb-1",children:"Color"}),(0,t.jsx)("div",{className:"font-medium text-sm flex items-center gap-2",children:(n=(i=(e=z.color||z.primary_color||"#FFFFFF").match(/#[0-9A-Fa-f]{6}/))?i[0]:e.startsWith("#")?e:"#FFFFFF",j=e.replace(/#[0-9A-Fa-f]{6}/,"").trim()||e,(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"w-4 h-4 rounded-full border border-white/30 shadow-sm",style:{backgroundColor:n}}),j]}))})]})]}),(0,t.jsxs)("div",{className:"bg-white/5 p-4 rounded-xl border border-white/10 hover:border-primary/30 transition-colors group cursor-pointer",onClick:async()=>{if("link"===N&&E)window.open(E,"_blank");else{let e=await (0,v.getFirstSearchResultUrl)(z.brand||"",z.item_name||z.sub_category||"",z.color||z.primary_color);window.open(e.url,"_blank")}},children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsxs)("div",{className:"text-xs text-primary font-bold uppercase tracking-wider flex items-center gap-1",children:["link"===N?(0,t.jsx)(c,{size:12}):(0,t.jsx)(p,{size:12}),"link"===N?"Product Link":"Find on Google"]}),(0,t.jsx)(m.ArrowRight,{size:14,className:"text-gray-500 group-hover:text-primary transition-colors opacity-0 group-hover:opacity-100 transform -translate-x-2 group-hover:translate-x-0"})]}),(0,t.jsx)("div",{className:"text-sm font-medium hover:text-primary underline decoration-primary/30 underline-offset-4",children:"View Purchasing Options"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-2 block flex items-center gap-1",children:[(0,t.jsx)(g,{size:12})," Style Tags"]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[z.tags?.map((e,r)=>(0,t.jsxs)("span",{className:"px-3 py-1 bg-white/5 text-gray-300 border border-white/10 rounded-full text-xs hover:bg-white/10 transition-colors cursor-default",children:["#",e]},r)),z.style_tags?.map((e,r)=>(0,t.jsxs)("span",{className:"px-3 py-1 bg-white/5 text-gray-300 border border-white/10 rounded-full text-xs hover:bg-white/10 transition-colors cursor-default",children:["#",e]},`s-${r}`))]})]})]}),(0,t.jsxs)("div",{className:"pt-8 flex gap-4 mt-auto",children:[(0,t.jsx)("button",{onClick:()=>U(null),className:"btn btn-outline flex-1 py-4 text-sm",children:"Cancel"}),(0,t.jsx)("button",{onClick:G,className:"btn btn-primary flex-[2] py-4 text-sm group shadow-lg shadow-primary/20",children:"Add to Wardrobe"})]})]})]})]})]})}e.s(["default",()=>j],6339)}]);