(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,62636,e=>{"use strict";var t,n,s,i,o,a,r,l,c,d,u,h,g,f,m,p,y,E,C,_,O,w,I,A;(g=t||(t={})).STRING="string",g.NUMBER="number",g.INTEGER="integer",g.BOOLEAN="boolean",g.ARRAY="array",g.OBJECT="object",(f=n||(n={})).LANGUAGE_UNSPECIFIED="language_unspecified",f.PYTHON="python",(m=s||(s={})).OUTCOME_UNSPECIFIED="outcome_unspecified",m.OUTCOME_OK="outcome_ok",m.OUTCOME_FAILED="outcome_failed",m.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded";let T=["user","model","function","system"];(p=i||(i={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",p.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",p.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",p.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",p.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",p.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(y=o||(o={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",y.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",y.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",y.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",y.BLOCK_NONE="BLOCK_NONE",(E=a||(a={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",E.NEGLIGIBLE="NEGLIGIBLE",E.LOW="LOW",E.MEDIUM="MEDIUM",E.HIGH="HIGH",(C=r||(r={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",C.SAFETY="SAFETY",C.OTHER="OTHER",(_=l||(l={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",_.STOP="STOP",_.MAX_TOKENS="MAX_TOKENS",_.SAFETY="SAFETY",_.RECITATION="RECITATION",_.LANGUAGE="LANGUAGE",_.BLOCKLIST="BLOCKLIST",_.PROHIBITED_CONTENT="PROHIBITED_CONTENT",_.SPII="SPII",_.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",_.OTHER="OTHER",(O=c||(c={})).TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",O.RETRIEVAL_QUERY="RETRIEVAL_QUERY",O.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",O.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",O.CLASSIFICATION="CLASSIFICATION",O.CLUSTERING="CLUSTERING",(w=d||(d={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",w.AUTO="AUTO",w.ANY="ANY",w.NONE="NONE",(I=u||(u={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",I.MODE_DYNAMIC="MODE_DYNAMIC";class N extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class b extends N{constructor(e,t){super(e),this.response=t}}class v extends N{constructor(e,t,n,s){super(e),this.status=t,this.statusText=n,this.errorDetails=s}}class S extends N{}class R extends N{}(A=h||(h={})).GENERATE_CONTENT="generateContent",A.STREAM_GENERATE_CONTENT="streamGenerateContent",A.COUNT_TOKENS="countTokens",A.EMBED_CONTENT="embedContent",A.BATCH_EMBED_CONTENTS="batchEmbedContents";class ${constructor(e,t,n,s,i){this.model=e,this.task=t,this.apiKey=n,this.stream=s,this.requestOptions=i}toString(){var e,t;let n=(null==(e=this.requestOptions)?void 0:e.apiVersion)||"v1beta",s=(null==(t=this.requestOptions)?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com",i=`${s}/${n}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}async function M(e){var t,n;let s,i=new Headers;i.append("Content-Type","application/json"),i.append("x-goog-api-client",(n=e.requestOptions,s=[],(null==n?void 0:n.apiClient)&&s.push(n.apiClient),s.push("genai-js/0.24.1"),s.join(" "))),i.append("x-goog-api-key",e.apiKey);let o=null==(t=e.requestOptions)?void 0:t.customHeaders;if(o){if(!(o instanceof Headers))try{o=new Headers(o)}catch(e){throw new S(`unable to convert customHeaders value ${JSON.stringify(o)} to Headers: ${e.message}`)}for(let[e,t]of o.entries()){if("x-goog-api-key"===e)throw new S(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new S(`Header name ${e} can only be set using the apiClient field`);i.append(e,t)}}return i}async function x(e,t,n,s,i,o){let a=new $(e,t,n,s,o);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},function(e){let t={};if((null==e?void 0:e.signal)!==void 0||(null==e?void 0:e.timeout)>=0){let n=new AbortController;(null==e?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),(null==e?void 0:e.signal)&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}(o)),{method:"POST",headers:await M(a),body:i})}}async function D(e,t,n,s,i,o={},a=fetch){let{url:r,fetchOptions:l}=await x(e,t,n,s,i,o);return L(r,l,a)}async function L(e,t,n=fetch){let s;try{s=await n(e,t)}catch(n){var i=n,o=e;let t=i;throw"AbortError"===t.name?(t=new R(`Request aborted when fetching ${o.toString()}: ${i.message}`)).stack=i.stack:i instanceof v||i instanceof S||((t=new N(`Error fetching from ${o.toString()}: ${i.message}`)).stack=i.stack),t}return s.ok||await G(s,e),s}async function G(e,t){let n,s="";try{let t=await e.json();s=t.error.message,t.error.details&&(s+=` ${JSON.stringify(t.error.details)}`,n=t.error.details)}catch(e){}throw new v(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${s}`,e.status,e.statusText,n)}function P(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),B(e.candidates[0]))throw new b(`${j(e)}`,e);return function(e){var t,n,s,i;let o=[];if(null==(n=null==(t=e.candidates)?void 0:t[0].content)?void 0:n.parts)for(let t of null==(i=null==(s=e.candidates)?void 0:s[0].content)?void 0:i.parts)t.text&&o.push(t.text),t.executableCode&&o.push("\n```"+t.executableCode.language+"\n"+t.executableCode.code+"\n```\n"),t.codeExecutionResult&&o.push("\n```\n"+t.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}(e)}if(e.promptFeedback)throw new b(`Text not available. ${j(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),B(e.candidates[0]))throw new b(`${j(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),U(e)[0]}if(e.promptFeedback)throw new b(`Function call not available. ${j(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),B(e.candidates[0]))throw new b(`${j(e)}`,e);return U(e)}if(e.promptFeedback)throw new b(`Function call not available. ${j(e)}`,e)},e}function U(e){var t,n,s,i;let o=[];if(null==(n=null==(t=e.candidates)?void 0:t[0].content)?void 0:n.parts)for(let t of null==(i=null==(s=e.candidates)?void 0:s[0].content)?void 0:i.parts)t.functionCall&&o.push(t.functionCall);return o.length>0?o:void 0}let k=[l.RECITATION,l.SAFETY,l.LANGUAGE];function B(e){return!!e.finishReason&&k.includes(e.finishReason)}function j(e){var t,n,s;let i="";if((!e.candidates||0===e.candidates.length)&&e.promptFeedback)i+="Response was blocked",(null==(t=e.promptFeedback)?void 0:t.blockReason)&&(i+=` due to ${e.promptFeedback.blockReason}`),(null==(n=e.promptFeedback)?void 0:n.blockReasonMessage)&&(i+=`: ${e.promptFeedback.blockReasonMessage}`);else if(null==(s=e.candidates)?void 0:s[0]){let t=e.candidates[0];B(t)&&(i+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(i+=`: ${t.finishMessage}`))}return i}function F(e){return this instanceof F?(this.v=e,this):new F(e)}"function"==typeof SuppressedError&&SuppressedError;let H=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function Y(e){let t=[],n=e.getReader();for(;;){let{done:e,value:s}=await n.read();if(e)return P(function(e){let t=e[e.length-1],n={promptFeedback:null==t?void 0:t.promptFeedback};for(let t of e){if(t.candidates){let e=0;for(let s of t.candidates)if(n.candidates||(n.candidates=[]),n.candidates[e]||(n.candidates[e]={index:e}),n.candidates[e].citationMetadata=s.citationMetadata,n.candidates[e].groundingMetadata=s.groundingMetadata,n.candidates[e].finishReason=s.finishReason,n.candidates[e].finishMessage=s.finishMessage,n.candidates[e].safetyRatings=s.safetyRatings,s.content&&s.content.parts){n.candidates[e].content||(n.candidates[e].content={role:s.content.role||"user",parts:[]});let t={};for(let i of s.content.parts)i.text&&(t.text=i.text),i.functionCall&&(t.functionCall=i.functionCall),i.executableCode&&(t.executableCode=i.executableCode),i.codeExecutionResult&&(t.codeExecutionResult=i.codeExecutionResult),0===Object.keys(t).length&&(t.text=""),n.candidates[e].content.parts.push(t)}e++}t.usageMetadata&&(n.usageMetadata=t.usageMetadata)}return n}(t));t.push(s)}}async function K(e,t,n,s){return function(e){let t,[n,s]=(t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})).getReader(),new ReadableStream({start(e){let n="";return function s(){return t.read().then(({value:t,done:i})=>{let o;if(i)return n.trim()?void e.error(new N("Failed to parse stream")):void e.close();let a=(n+=t).match(H);for(;a;){try{o=JSON.parse(a[1])}catch(t){e.error(new N(`Error parsing JSON response: "${a[1]}"`));return}e.enqueue(o),a=(n=n.substring(a[0].length)).match(H)}return s()}).catch(e=>{let t=e;throw t.stack=e.stack,t="AbortError"===t.name?new R("Request aborted when reading from the stream"):new N("Error reading from the stream")})}()}})).tee();return{stream:function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var s,i=n.apply(e,t||[]),o=[];return s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s;function a(e){i[e]&&(s[e]=function(t){return new Promise(function(n,s){o.push([e,t,n,s])>1||r(e,t)})})}function r(e,t){try{var n;(n=i[e](t)).value instanceof F?Promise.resolve(n.value.v).then(l,c):d(o[0][2],n)}catch(e){d(o[0][3],e)}}function l(e){r("next",e)}function c(e){r("throw",e)}function d(e,t){e(t),o.shift(),o.length&&r(o[0][0],o[0][1])}}(this,arguments,function*(){let t=e.getReader();for(;;){let{value:e,done:n}=yield F(t.read());if(n)break;yield yield F(P(e))}})}(n),response:Y(s)}}(await D(t,h.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),s))}async function q(e,t,n,s){let i=await D(t,h.GENERATE_CONTENT,e,!1,JSON.stringify(n),s);return{response:P(await i.json())}}function J(e){if(null!=e){if("string"==typeof e)return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)if(!e.role)return{role:"system",parts:e.parts};else return e}}function W(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(let n of e)"string"==typeof n?t.push({text:n}):t.push(n);var n=t;let s={role:"user",parts:[]},i={role:"function",parts:[]},o=!1,a=!1;for(let e of n)"functionResponse"in e?(i.parts.push(e),a=!0):(s.parts.push(e),o=!0);if(o&&a)throw new N("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!o&&!a)throw new N("No content is provided for sending chat message.");return o?s:i}function V(e){let t;return t=e.contents?e:{contents:[W(e)]},e.systemInstruction&&(t.systemInstruction=J(e.systemInstruction)),t}let z=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],X={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Q(e){var t;if(void 0===e.candidates||0===e.candidates.length)return!1;let n=null==(t=e.candidates[0])?void 0:t.content;if(void 0===n||void 0===n.parts||0===n.parts.length)return!1;for(let e of n.parts)if(void 0===e||0===Object.keys(e).length||void 0!==e.text&&""===e.text)return!1;return!0}let Z="SILENT_ERROR";class ee{constructor(e,t,n,s={}){this.model=t,this.params=n,this._requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==n?void 0:n.history)&&(!function(e){let t=!1;for(let n of e){let{role:e,parts:s}=n;if(!t&&"user"!==e)throw new N(`First content should be with role 'user', got ${e}`);if(!T.includes(e))throw new N(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(T)}`);if(!Array.isArray(s))throw new N("Content should have 'parts' property with an array of Parts");if(0===s.length)throw new N("Each Content should have at least one part");let i={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let e of s)for(let t of z)t in e&&(i[t]+=1);let o=X[e];for(let t of z)if(!o.includes(t)&&i[t]>0)throw new N(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var n,s,i,o,a,r;let l;await this._sendPromise;let c=W(e),d={safetySettings:null==(n=this.params)?void 0:n.safetySettings,generationConfig:null==(s=this.params)?void 0:s.generationConfig,tools:null==(i=this.params)?void 0:i.tools,toolConfig:null==(o=this.params)?void 0:o.toolConfig,systemInstruction:null==(a=this.params)?void 0:a.systemInstruction,cachedContent:null==(r=this.params)?void 0:r.cachedContent,contents:[...this._history,c]},u=Object.assign(Object.assign({},this._requestOptions),t);return this._sendPromise=this._sendPromise.then(()=>q(this._apiKey,this.model,d,u)).then(e=>{var t;if(Q(e.response)){this._history.push(c);let n=Object.assign({parts:[],role:"model"},null==(t=e.response.candidates)?void 0:t[0].content);this._history.push(n)}else{let t=j(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}l=e}).catch(e=>{throw this._sendPromise=Promise.resolve(),e}),await this._sendPromise,l}async sendMessageStream(e,t={}){var n,s,i,o,a,r;await this._sendPromise;let l=W(e),c={safetySettings:null==(n=this.params)?void 0:n.safetySettings,generationConfig:null==(s=this.params)?void 0:s.generationConfig,tools:null==(i=this.params)?void 0:i.tools,toolConfig:null==(o=this.params)?void 0:o.toolConfig,systemInstruction:null==(a=this.params)?void 0:a.systemInstruction,cachedContent:null==(r=this.params)?void 0:r.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),t),u=K(this._apiKey,this.model,c,d);return this._sendPromise=this._sendPromise.then(()=>u).catch(e=>{throw Error(Z)}).then(e=>e.response).then(e=>{if(Q(e)){this._history.push(l);let t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{let t=j(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}}).catch(e=>{e.message!==Z&&console.error(e)}),u}}async function et(e,t,n,s){return(await D(t,h.COUNT_TOKENS,e,!1,JSON.stringify(n),s)).json()}async function en(e,t,n,s){return(await D(t,h.EMBED_CONTENT,e,!1,JSON.stringify(n),s)).json()}async function es(e,t,n,s){let i=n.requests.map(e=>Object.assign(Object.assign({},e),{model:t}));return(await D(t,h.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:i}),s)).json()}class ei{constructor(e,t,n={}){this.apiKey=e,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=J(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var n;let s=V(e),i=Object.assign(Object.assign({},this._requestOptions),t);return q(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(n=this.cachedContent)?void 0:n.name},s),i)}async generateContentStream(e,t={}){var n;let s=V(e),i=Object.assign(Object.assign({},this._requestOptions),t);return K(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(n=this.cachedContent)?void 0:n.name},s),i)}startChat(e){var t;return new ee(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(t=this.cachedContent)?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){let n=function(e,t){var n;let s={model:null==t?void 0:t.model,generationConfig:null==t?void 0:t.generationConfig,safetySettings:null==t?void 0:t.safetySettings,tools:null==t?void 0:t.tools,toolConfig:null==t?void 0:t.toolConfig,systemInstruction:null==t?void 0:t.systemInstruction,cachedContent:null==(n=null==t?void 0:t.cachedContent)?void 0:n.name,contents:[]},i=null!=e.generateContentRequest;if(e.contents){if(i)throw new S("CountTokensRequest must have one of contents or generateContentRequest, not both.");s.contents=e.contents}else if(i)s=Object.assign(Object.assign({},s),e.generateContentRequest);else{let t=W(e);s.contents=[t]}return{generateContentRequest:s}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),s=Object.assign(Object.assign({},this._requestOptions),t);return et(this.apiKey,this.model,n,s)}async embedContent(e,t={}){let n="string"==typeof e||Array.isArray(e)?{content:W(e)}:e,s=Object.assign(Object.assign({},this._requestOptions),t);return en(this.apiKey,this.model,n,s)}async batchEmbedContents(e,t={}){let n=Object.assign(Object.assign({},this._requestOptions),t);return es(this.apiKey,this.model,e,n)}}class eo{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new N("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new ei(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,n){if(!e.name)throw new S("Cached content must contain a `name` field.");if(!e.model)throw new S("Cached content must contain a `model` field.");for(let n of["model","systemInstruction"])if((null==t?void 0:t[n])&&e[n]&&(null==t?void 0:t[n])!==e[n]){if("model"===n&&(t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue;throw new S(`Different value for "${n}" specified in modelParams (${t[n]}) and cachedContent (${e[n]})`)}let s=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new ei(this.apiKey,s,n)}}e.s(["GoogleGenerativeAI",()=>eo])},66654,e=>{"use strict";var t=e.i(62636);let n="gemini-3-pro-preview",s="gemini-2.5-flash",i="gemini-1.5-pro-latest",o="gemini-1.5-flash-latest";async function a(e){let t=[n,s,i,o];for(let n=0;n<t.length;n++){let s=t[n],i=n===t.length-1;try{return e.getGenerativeModel({model:s})}catch(e){if((e?.message?.includes("429")||e?.message?.includes("quota"))&&(console.warn(`Model ${s} quota exceeded, trying next model...`),!i)||(console.warn(`Model ${s} unavailable: ${e?.message}`),!i))continue;throw e}}return e.getGenerativeModel({model:o})}async function r(e,a,r,l){let c=new t.GoogleGenerativeAI(a),d=await h(e),u=r&&r.toLowerCase().includes("india")?"₹":"$",m=l&&l.length>0?`

User's Current Wardrobe:
${l.map((e,t)=>`${t+1}. ${e.name||e.category} (${e.color||"color N/A"})`).join("\n")}

For complementary_items, ONLY suggest items from the above wardrobe list by their exact names.`:'\n\nUser has no wardrobe items yet. For complementary_items, suggest 5 general item types (e.g., "White sneakers", "Navy chinos") that would pair well.',p=`Analyze this clothing item for a personal stylist app. Return ONLY a valid JSON object (no markdown, no backticks) with these fields:
    - category: string (Top, Bottom, Outerwear, Shoes, Accessory, Dress, Bag, Other)
    - sub_category: string (e.g., T-Shirt, Jeans, Blazer, Sneakers)
    - primary_color: string (precise color name AND hex code, e.g., "Navy Blue #1A2B3C", "Charcoal Gray #36454F", "Crimson Red #DC143C")
    - style_tags: string[] (e.g., ["casual", "streetwear", "minimalist", "vintage"])
    - description: string (short, engaging description)
    - price_estimate: string (e.g., "${u} 1500", "${u} 2000-5000") - use numeric values with currency symbol. Do NOT use abstract signs like $$$.
    - style_score: number (1-100, purely objective style rating based on versatility and trend)
    - style_reasoning: string (2-3 sentences explaining the style score and how this item fits into a wardrobe)
    - brand: string (brand name if visible, else empty)
    - styling_tips: string[] (3 short tips on how to style this item)
    - complementary_items: string[] (5 items that would pair well with this piece${l&&l.length>0?" - ONLY from the user's wardrobe list above":""})
    ${m}`,y=[n,s,i,o];for(let t=0;t<y.length;t++){let n=y[t],s=t===y.length-1;try{let t=c.getGenerativeModel({model:n}),s=await t.generateContent([p,{inlineData:{data:d,mimeType:e.type}}]),i=s.response.candidates?.[0]?.content?.parts?.[0]?.text||"";if(!i)throw Error("No text content in Gemini response");let o=g(i);return JSON.parse(o)}catch(e){if((e?.message?.includes("429")||e?.message?.includes("quota"))&&!s){console.warn(`Model ${n} quota exceeded, trying next model...`);continue}if(s)throw f(e);console.warn(`Model ${n} failed: ${e?.message}`);continue}}throw Error("All models failed")}async function l(e,a,r,l,c,d){let u=new t.GoogleGenerativeAI(l),m=c&&c.toLowerCase().includes("india")?"₹":"$",p=d&&d.length>0?`

User's Current Wardrobe:
${d.map((e,t)=>`${t+1}. ${e.name||e.category} (${e.color||"color N/A"})`).join("\n")}

For complementary_items, ONLY suggest items from the above wardrobe list by their exact names.`:"",y=`
    CONTEXT FROM LINK METADATA (Use as ground truth if available):
    URL: ${e}
    Title: "${a.title||""}"
    Brand: "${a.brand||""}"
    Price: "${a.price||""}"
    Description: "${a.description||""}"
    `,E=`Analyze this product from a URL store link. 
    ${y}
    
    Return ONLY a valid JSON object (no markdown, no backticks) with these fields:
    - category: string (Top, Bottom, Outerwear, Shoes, Accessory, Dress, Bag, Other)
    - sub_category: string (e.g., T-Shirt, Jeans, Blazer, Sneakers)
    - primary_color: string (precise color name AND hex code, e.g., "Navy Blue #1A2B3C")
    - style_tags: string[] (e.g., ["casual", "streetwear", "minimalist", "vintage"])
    - description: string (short, engaging description based on the link info)
    - price_estimate: string (Use the metadata price if available, else estimate: "${m} 1500", "${m} 2000-5000")
    - style_score: number (1-100, purely objective style rating)
    - style_reasoning: string (2-3 sentences explaining the style score)
    - brand: string (Use metadata brand if available - "${a.brand||""}")
    - styling_tips: string[] (3 short tips)
    - complementary_items: string[] (5 items that would pair well - ${d&&d.length>0?"ONLY from user wardrobe":"generics"})
    ${p}`,C=[n,s,i,o];for(let e=0;e<C.length;e++){let t=C[e];try{let e=u.getGenerativeModel({model:t}),n=[E];if(r){let e=await h(r);n.push({inlineData:{data:e,mimeType:r.type}})}let s=await e.generateContent(n),i=s.response.candidates?.[0]?.content?.parts?.[0]?.text||"";if(!i)throw Error("No text content");return JSON.parse(g(i))}catch(n){if(console.warn(`Model ${t} failed for Link Analysis: ${n?.message}`),e===C.length-1)throw f(n)}}throw Error("All models failed")}async function c(e,a){let r=new t.GoogleGenerativeAI(a),l=await h(e),c=`Act as a world-class fashion stylist. Rate this item/outfit on a scale of 1-10.
        Return ONLY a valid JSON object (no markdown) with:
        - score: number (1-10)
        - critique: string (honest, constructive feedback, max 2 sentences)
        - alternatives: string[] (3 better alternative item names or styles)
        `,d=[n,s,i,o];for(let t=0;t<d.length;t++){let n=d[t],s=t===d.length-1;try{let t=r.getGenerativeModel({model:n}),s=await t.generateContent([c,{inlineData:{data:l,mimeType:e.type}}]),i=s.response.candidates?.[0]?.content?.parts?.[0]?.text||"";if(!i)throw Error("No text content in Gemini response");let o=g(i);return JSON.parse(o)}catch(e){if((e?.message?.includes("429")||e?.message?.includes("quota"))&&!s){console.warn(`Model ${n} quota exceeded, trying next model...`);continue}if(s)throw f(e);console.warn(`Model ${n} failed: ${e?.message}`);continue}}throw Error("All models failed")}async function d(e,n,s,i,o,r){if(!o)throw Error("API Key required");let l=new t.GoogleGenerativeAI(o),c=r&&r.length>0?`CRITICAL INSTRUCTION: You MUST include the following Item IDs in your outfit selection: ${r.join(", ")}. Build the rest of the outfit around these items.`:"",d=e.map(e=>`- ID: ${e.id}, ${e.name||e.sub_category} (${e.category}, ${e.primary_color||"color N/A"})`).join("\n"),u=`
    Act as the world's most prestigious and talented personal stylist, known for impeccable taste and attention to detail. 
    You are styling your most important client for a specific occasion. Your goal is perfection.

    OCCASION: ${n}
    TIMING: ${s}
    LOCATION: ${i||"Unknown"}
    
    WARDROBE ITEMS:
    ${d}

    INSTRUCTIONS:
    1. Select the ABSOLUTE BEST combination of items from the provided WARDROBE ITEMS list.
    2. Ensure colors, textures, and styles harmonize perfectly.
    3. Respect the occasion deeply(e.g., ensure formal wear is truly formal).
    4. You MUST use the exact ID provided in the list.
    5. ${c}
    
    Return verified JSON only:
    {
        "top_id": "uuid",
        "bottom_id": "uuid",
        "shoes_id": "uuid",
        "layering_id": "uuid",
        "bag_id": "uuid",
        "sunglasses_id": "uuid",
        "jewelry_id": "uuid",
        "headwear_id": "uuid",
        "belt_id": "uuid",
        "scarf_id": "uuid",
        "gloves_id": "uuid",
        "watch_id": "uuid",
        "wallet_id": "uuid",
        "reasoning": "Sophisticated styling advice explaining why this specific combination works flawlessly for the occasion.",
        "style_tips": ["Professional styling tip 1", "Tip 2"]
    }
    `,h=await a(l),f=await h.generateContent(u),m=JSON.parse(g(f.response.candidates?.[0]?.content?.parts?.[0]?.text||"")),p=t=>e.find(e=>e.id===t);return{top:p(m.top_id),bottom:p(m.bottom_id),shoes:p(m.shoes_id),layering:p(m.layering_id),bag:p(m.bag_id),sunglasses:p(m.sunglasses_id),jewelry:p(m.jewelry_id),headwear:p(m.headwear_id),belt:p(m.belt_id),scarf:p(m.scarf_id),gloves:p(m.gloves_id),watch:p(m.watch_id),wallet:p(m.wallet_id),reasoning:m.reasoning,style_tips:m.style_tips}}async function u(e,n,s){if(!s)throw Error("API Key required");let i=new t.GoogleGenerativeAI(s),o=n.map(e=>`- ${e.category} (${e.sub_category}): ${e.name} (${e.primary_color}, ${e.style_tags?.join(", ")})`).join("\n"),r=JSON.stringify(e,null,2),l=`
    Act as a world-class personal stylist. Analyze the user's Style DNA and current Wardrobe to identify the top 5-6 MISSING items (gaps) that would elevate their style.

    STYLE DNA:
    ${r}

    CURRENT WARDROBE:
    ${o}

    TASK:
    1. Identify 5-6 key items missing from the wardrobe that are CRITICAL to fulfilling the Style DNA archetypes.
    2. Suggest SPECIFIC items (e.g. "Camel Wool Trench Coat" instead of just "Coat").
    3. For EACH recommendation, provide exactly 3 "Shopping Options" with varying price points or styles (e.g. one Classic, one Modern, one Budget/Premium).
    4. Ensure specific Brand names are real and relevant to the user's style.

    Return verified JSON only (Array of objects):
    [
      {
        "item_name": "Detailed Item Name",
        "priority": "High",
        "reason": "Explanation of why this is a critical gap based on their archetype...",
        "options": [
          { "brand": "Brand A", "color": "Specific Color", "price_range_text": "$100-200" },
          { "brand": "Brand B", "color": "Specific Color", "price_range_text": "$200-500" },
          { "brand": "Brand C", "color": "Specific Color", "price_range_text": "$50+" }
        ]
      }
    ]
    `,c=await a(i),d=await c.generateContent(l);return JSON.parse(g(d.response.candidates?.[0]?.content?.parts?.[0]?.text||""))}async function h(e){return new Promise((t,n)=>{let s=new FileReader;s.onloadend=()=>{t(s.result.split(",")[1])},s.onerror=n,s.readAsDataURL(e)})}function g(e){return e.replace(/```json/g,"").replace(/```/g,"").trim()}function f(e){console.error("Gemini Error:",e);let t="Failed to analyze image. Please check your API key.";return e instanceof Error&&(e.message.includes("429")||e.message.includes("quota")?t="All Gemini models exhausted quota limits. Free tier has daily limits. Please wait or upgrade at https://ai.google.dev/pricing":e.message.includes("404")||e.message.includes("not found")?t="Gemini model unavailable. Please check your API key has access to the latest models.":(e.message.includes("API key")||e.message.includes("API_KEY"))&&(t="Invalid API Key. Please check your settings.")),Error(t)}e.s(["analyzeImageWithGemini",()=>r,"analyzeLinkWithGemini",()=>l,"generateOutfit",()=>d,"generateWeeklyRecommendations",()=>u,"rateImageWithGemini",()=>c])}]);